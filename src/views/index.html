<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kibrary LMS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Kibrary</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#" id="nav-home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-dashboard">Dashboard</a>
                    </li>
                    <!-- Admin/Librarian links will go here -->
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-admin-books" style="display:none;">Manage Books</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-admin-users" style="display:none;">Manage Users</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-admin-transactions" style="display:none;">Manage Transactions</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-admin-reports" style="display:none;">Reports</a>
                    </li>
                </ul>
                <div class="d-flex">
                    <button class="btn btn-outline-success" id="login-btn">Login</button>
                    <button class="btn btn-outline-danger" id="logout-btn" style="display:none;">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div id="auth-section">
            <h2>Login</h2>
            <form id="login-form">
                <div class="mb-3">
                    <label for="email" class="form-label">Email address</label>
                    <input type="email" class="form-control" id="login-email" required>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" class="form-control" id="login-password" required>
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
                <div id="login-message" class="mt-3"></div>
            </form>
        </div>

        <div id="search-browse-section" class="mt-4" style="display:none;">
            <h2>Library Catalog</h2>
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="Search by title, author, or ISBN" id="search-input">
                <button class="btn btn-outline-secondary" type="button" id="search-button">Search</button>
            </div>
            <div id="book-list" class="row row-cols-1 row-cols-md-3 g-4"></div>
        </div>

        <div id="personal-dashboard-section" class="mt-4" style="display:none;">
            <h2>Your Dashboard</h2>
            <div id="user-info" class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">Welcome, <span id="dashboard-full-name"></span>!</h5>
                    <p class="card-text">Member ID: <span id="dashboard-member-id"></span></p>
                    <p class="card-text">Email: <span id="dashboard-email"></span></p>
                    <p class="card-text">Role: <span id="dashboard-role"></span></p>
                </div>
            </div>

            <h3>Currently Borrowed Books</h3>
            <div id="borrowed-books-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Author</th>
                            <th>Barcode</th>
                            <th>Borrow Date</th>
                            <th>Due Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Borrowed books will be loaded here -->
                    </tbody>
                </table>
            </div>

            <h3 class="mt-4">Borrowing History</h3>
            <div id="borrowing-history-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Author</th>
                            <th>Barcode</th>
                            <th>Borrow Date</th>
                            <th>Due Date</th>
                            <th>Return Date</th>
                            <th>Fine</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Borrowing history will be loaded here -->
                    </tbody>
                </table>
            </div>

            <h3 class="mt-4">Your Reservations</h3>
            <div id="pending-reservations-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Author</th>
                            <th>Reservation Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Pending reservations will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Admin Panels (initially hidden) -->
        <div id="admin-books-section" class="mt-4" style="display:none;">
            <h2>Manage Books</h2>
            <button class="btn btn-primary mb-3" id="add-book-btn">Add New Book</button>

            <div id="book-form-container" style="display:none;" class="card card-body mb-4">
                <h3><span id="book-form-title">Add</span> Book</h3>
                <form id="book-form">
                    <input type="hidden" id="book-id">
                    <div class="mb-3">
                        <label for="book-title" class="form-label">Title</label>
                        <input type="text" class="form-control" id="book-title" required>
                    </div>
                    <div class="mb-3">
                        <label for="book-author" class="form-label">Author</label>
                        <input type="text" class="form-control" id="book-author" required>
                    </div>
                    <div class="mb-3">
                        <label for="book-isbn" class="form-label">ISBN</label>
                        <input type="text" class="form-control" id="book-isbn" required>
                    </div>
                    <div class="mb-3">
                        <label for="book-publication-year" class="form-label">Publication Year</label>
                        <input type="number" class="form-control" id="book-publication-year">
                    </div>
                    <div class="mb-3">
                        <label for="book-category" class="form-label">Category/Genre</label>
                        <input type="text" class="form-control" id="book-category">
                    </div>
                    <div class="mb-3">
                        <label for="book-total-copies" class="form-label">Total Copies</label>
                        <input type="number" class="form-control" id="book-total-copies" required>
                    </div>
                    <button type="submit" class="btn btn-success">Save Book</button>
                    <button type="button" class="btn btn-secondary" id="cancel-book-form-btn">Cancel</button>
                </form>
                <div id="book-form-message" class="mt-3"></div>
            </div>

            <h3>Current Books</h3>
            <div id="admin-book-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Title</th>
                            <th>Author</th>
                            <th>ISBN</th>
                            <th>Category</th>
                            <th>Total Copies</th>
                            <th>Available Copies</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Books will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="admin-users-section" class="mt-4" style="display:none;">
            <h2>Manage Users</h2>
            <button class="btn btn-primary mb-3" id="add-user-btn">Add New User</button>

            <div id="user-form-container" style="display:none;" class="card card-body mb-4">
                <h3><span id="user-form-title">Add</span> User</h3>
                <form id="user-form">
                    <input type="hidden" id="user-id">
                    <div class="mb-3">
                        <label for="user-member-id" class="form-label">Member ID</label>
                        <input type="text" class="form-control" id="user-member-id" required>
                    </div>
                    <div class="mb-3">
                        <label for="user-full-name" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="user-full-name" required>
                    </div>
                    <div class="mb-3">
                        <label for="user-email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="user-email" required>
                    </div>
                    <div class="mb-3">
                        <label for="user-phone" class="form-label">Phone</label>
                        <input type="text" class="form-control" id="user-phone">
                    </div>
                    <div class="mb-3">
                        <label for="user-password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="user-password">
                        <small class="form-text text-muted">Leave blank to keep current password when editing.</small>
                    </div>
                    <div class="mb-3">
                        <label for="user-role" class="form-label">Role</label>
                        <select class="form-select" id="user-role">
                            <option value="patron">Patron</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="user-account-status" class="form-label">Account Status</label>
                        <select class="form-select" id="user-account-status">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="suspended">Suspended</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success">Save User</button>
                    <button type="button" class="btn btn-secondary" id="cancel-user-form-btn">Cancel</button>
                </form>
                <div id="user-form-message" class="mt-3"></div>
            </div>

            <h3>Current Users</h3>
            <div id="admin-user-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Member ID</th>
                            <th>Full Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Users will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="admin-transactions-section" class="mt-4" style="display:none;">
            <h2>Manage Transactions</h2>

            <h3>Borrow Book</h3>
            <div class="card card-body mb-4">
                <form id="borrow-book-form">
                    <div class="mb-3">
                        <label for="borrow-barcode" class="form-label">Book Copy Barcode</label>
                        <input type="text" class="form-control" id="borrow-barcode" required>
                    </div>
                    <div class="mb-3">
                        <label for="borrow-user-id" class="form-label">Member ID (User ID)</label>
                        <input type="number" class="form-control" id="borrow-user-id" required>
                    </div>
                    <button type="submit" class="btn btn-success">Borrow Book</button>
                </form>
                <div id="borrow-message" class="mt-3"></div>
            </div>

            <h3>Return Book</h3>
            <div class="card card-body mb-4">
                <form id="return-book-form">
                    <div class="mb-3">
                        <label for="return-transaction-id" class="form-label">Transaction ID</label>
                        <input type="number" class="form-control" id="return-transaction-id" required>
                    </div>
                    <button type="submit" class="btn btn-info">Return Book</button>
                </form>
                <div id="return-message" class="mt-3"></div>
            </div>

            <h3>Book Copies Inventory</h3>
            <div id="admin-book-copies-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Book ID</th>
                            <th>Barcode</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Book copies will be loaded here -->
                    </tbody>
                </table>
            </div>

            <h3 class="mt-4">All Transactions</h3>
            <div id="admin-transaction-list" class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Book Title</th>
                            <th>Member Name</th>
                            <th>Barcode</th>
                            <th>Borrow Date</th>
                            <th>Due Date</th>
                            <th>Return Date</th>
                            <th>Fine</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Transactions will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="admin-reports-section" class="mt-4" style="display:none;">
            <h2>Reports</h2>
            <div class="row">
                <div class="col-md-6">
                    <h3>Overdue Books</h3>
                    <div id="overdue-books-report" class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Member</th>
                                    <th>Barcode</th>
                                    <th>Due Date</th>
                                    <th>Overdue Days</th>
                                    <th>Fine Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Overdue books will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-md-6">
                    <h3>Most Popular Books (Top 10)</h3>
                    <div id="popular-books-report" class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Author</th>
                                    <th>ISBN</th>
                                    <th>Borrows</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Popular books will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <h3 class="mt-4">Total Registered Members</h3>
            <p id="total-members-report">Loading...</p>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
